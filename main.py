import pyperclip as clip
import time
import wmi
import json2dict as j2d

path = str(input("Enter Module to be used : "))
module = j2d.load_json(path)

# Start of copy and paste process of clipboard
def start():
      question = str(clip.paste())
      ans = str(search(question))
      clip.copy(ans)
      print("Done")

# Search Function to search answers with questions
def search(question):
    print("Searching")
    for i in module:
        if i == question:
            return module[i]

# Define WMI Batter Class     
def battery():
    c = wmi.WMI()
    battery_info = c.Win32_Battery()[0]
    return battery_info

# Main function
def main():

    while True:
        event = battery()
        # Battery Discharging State
        if event.BatteryStatus == 1:
            start()
            time.sleep(5)
            continue

# Main
if __name__ == "__main__":
    main()

        
